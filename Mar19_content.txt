CASE([
AND( Region == '', Country == 'USA' ), state_id,
AND( Region == '', Country != 'USA' ), City, 
Region != '', Region
])